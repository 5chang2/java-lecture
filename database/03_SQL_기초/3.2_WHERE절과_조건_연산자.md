# 3.2. WHERE 절과 조건 연산자

> WHERE 절을 사용하여 조건에 맞는 데이터만 필터링할 수 있다.

---

## 1. WHERE 절이란?

`WHERE` 절은 테이블에서 **조건에 맞는 데이터만** 선택하는 필터입니다.

### 기본 구조

```sql
SELECT 컬럼명
FROM 테이블명
WHERE 조건;
```

**예시**:
```sql
-- 가격이 10만원 이상인 상품만 조회
SELECT * FROM products WHERE price >= 100000;
```

---

## 2. 비교 연산자

### 2.1. 기본 비교 연산자

| 연산자 | 의미 | 예시 |
|--------|------|------|
| `=` | 같다 | `age = 25` |
| `!=` 또는 `<>` | 같지 않다 | `age != 25`, `age <> 25` |
| `>` | 크다 | `price > 10000` |
| `<` | 작다 | `price < 10000` |
| `>=` | 크거나 같다 | `price >= 10000` |
| `<=` | 작거나 같다 | `price <= 10000` |

### 2.2. 예시

```sql
-- 재고가 20개 이상인 상품
SELECT * FROM products WHERE stock >= 20;

-- 카테고리가 '전자제품'인 상품
SELECT * FROM products WHERE category = '전자제품';

-- 가격이 50000원이 아닌 상품
SELECT * FROM products WHERE price != 50000;
```

**결과 확인**:
```sql
-- 전자제품만 조회
SELECT product_name, category, price
FROM products
WHERE category = '전자제품';
```

**결과**:
```
+------------+----------+---------+
|product_name|category  |price    |
+------------+----------+---------+
| 노트북     |전자제품  |1500000  |
| 마우스     |전자제품  |25000    |
| 키보드     |전자제품  |80000    |
| 모니터     |전자제품  |300000   |
+------------+----------+---------+
```

---

## 3. 논리 연산자

여러 조건을 조합하여 더 정교한 필터링을 수행합니다.

### 3.1. AND (그리고)

**모든 조건이 참**일 때만 결과를 반환합니다.

```sql
-- 전자제품이면서 가격이 100000원 이상인 상품
SELECT product_name, category, price
FROM products
WHERE category = '전자제품' AND price >= 100000;
```

**결과**:
```
+------------+----------+---------+
|product_name|category  |price    |
+------------+----------+---------+
| 노트북     |전자제품  |1500000  |
| 모니터     |전자제품  |300000   |
+------------+----------+---------+
```

### 3.2. OR (또는)

**조건 중 하나라도 참**이면 결과를 반환합니다.

```sql
-- 카테고리가 '가구' 또는 '문구'인 상품
SELECT product_name, category
FROM products
WHERE category = '가구' OR category = '문구';
```

**결과**:
```
+------------+----------+
|product_name|category  |
+------------+----------+
| 책상       |가구      |
| 의자       |가구      |
| 노트       |문구      |
| 펜         |문구      |
+------------+----------+
```

### 3.3. NOT (부정)

조건을 **반대로** 만듭니다.

```sql
-- 전자제품이 아닌 상품
SELECT product_name, category
FROM products
WHERE NOT category = '전자제품';

-- 또는
SELECT product_name, category
FROM products
WHERE category != '전자제품';
```

### 3.4. 복합 조건

괄호 `()`를 사용하여 우선순위를 명확히 할 수 있습니다.

```sql
-- 전자제품이면서 가격이 100000원 미만이거나, 문구 카테고리인 상품
SELECT product_name, category, price
FROM products
WHERE (category = '전자제품' AND price < 100000)
   OR category = '문구';
```

**결과**:
```
+------------+----------+--------+
|product_name|category  |price   |
+------------+----------+--------+
| 마우스     |전자제품  |25000   |
| 키보드     |전자제품  |80000   |
| 노트       |문구      |2000    |
| 펜         |문구      |1000    |
+------------+----------+--------+
```

---

## 4. 범위 연산자

### 4.1. BETWEEN

값이 **특정 범위 안에 있는지** 확인합니다. 경계값 포함.

```sql
-- 가격이 50000원 이상 300000원 이하인 상품
SELECT product_name, price
FROM products
WHERE price BETWEEN 50000 AND 300000;

-- 위 쿼리는 다음과 같습니다
SELECT product_name, price
FROM products
WHERE price >= 50000 AND price <= 300000;
```

**결과**:
```
+------------+---------+
|product_name|price    |
+------------+---------+
| 키보드     |80000    |
| 모니터     |300000   |
| 책상       |150000   |
| 의자       |200000   |
+------------+---------+
```

### 4.2. IN

값이 **목록 안에 포함**되어 있는지 확인합니다.

```sql
-- 카테고리가 '가구' 또는 '문구'인 상품
SELECT product_name, category
FROM products
WHERE category IN ('가구', '문구');

-- 위 쿼리는 다음과 같습니다
SELECT product_name, category
FROM products
WHERE category = '가구' OR category = '문구';
```

**NOT IN**:
```sql
-- 전자제품이 아닌 상품
SELECT product_name, category
FROM products
WHERE category NOT IN ('전자제품');
```

---

## 5. 패턴 매칭 (LIKE)

문자열의 **일부가 일치**하는 데이터를 찾습니다.

### 5.1. 와일드카드

| 기호 | 의미 | 예시 |
|------|------|------|
| `%` | 0개 이상의 문자 | `'노%'` → 노트북, 노트 |
| `_` | 정확히 1개의 문자 | `'_자'` → 의자 |

### 5.2. 예시

```sql
-- 이름이 '노'로 시작하는 상품
SELECT product_name FROM products WHERE product_name LIKE '노%';
-- 결과: 노트북, 노트

-- 이름에 '자'가 포함된 상품
SELECT product_name FROM products WHERE product_name LIKE '%자%';
-- 결과: 의자

-- 이름이 정확히 2글자이고 두 번째 글자가 '자'인 상품
SELECT product_name FROM products WHERE product_name LIKE '_자';
-- 결과: 의자

-- 이름이 '북'으로 끝나는 상품
SELECT product_name FROM products WHERE product_name LIKE '%북';
-- 결과: 노트북
```

### 5.3. LIKE 주의사항

- `%`와 `_`는 성능에 영향을 줄 수 있음 (특히 앞에 `%`가 있을 때)
- 대소문자 구분은 DBMS 설정에 따라 다름 (MySQL은 기본적으로 구분 안 함)

---

## 6. NULL 처리

### 6.1. IS NULL / IS NOT NULL

`NULL`은 "값이 없음"을 의미하며, **`=`로 비교할 수 없습니다**.

```sql
-- 잘못된 예
SELECT * FROM products WHERE price = NULL;  -- 작동하지 않음

-- 올바른 예
SELECT * FROM products WHERE price IS NULL;
SELECT * FROM products WHERE price IS NOT NULL;
```

### 6.2. NULL 테스트

```sql
-- 테스트를 위해 NULL 데이터 추가
INSERT INTO products (product_name, category, price, stock)
VALUES ('미정 상품', '기타', NULL, 0);

-- NULL 가격인 상품 조회
SELECT product_name, price FROM products WHERE price IS NULL;
-- 결과: 미정 상품

-- NULL이 아닌 가격인 상품 조회
SELECT product_name, price FROM products WHERE price IS NOT NULL;
```

---

## 7. 실전 예시

### 예시 1: 재고 부족 상품 찾기

```sql
-- 재고가 10개 이하인 상품
SELECT product_name, stock
FROM products
WHERE stock <= 10
ORDER BY stock ASC;
```

### 예시 2: 특정 가격대 상품 검색

```sql
-- 10000원 이상 100000원 이하인 상품
SELECT product_name, price
FROM products
WHERE price BETWEEN 10000 AND 100000;
```

### 예시 3: 복잡한 조건 조합

```sql
-- 전자제품 중에서 가격이 50000원 이상이거나,
-- 문구 중에서 재고가 150개 이상인 상품
SELECT product_name, category, price, stock
FROM products
WHERE (category = '전자제품' AND price >= 50000)
   OR (category = '문구' AND stock >= 150);
```

---

## 실습 문제

### 문제 1: 비교 연산자

다음 요구사항에 맞는 SQL을 작성하세요.

1. 가격이 100000원 이상인 상품 조회
2. 재고가 50개보다 적은 상품의 이름과 재고량 조회
3. 카테고리가 '가구'인 상품 조회

**예상 답**:
```sql
-- 1
SELECT * FROM products WHERE price >= 100000;

-- 2
SELECT product_name, stock FROM products WHERE stock < 50;

-- 3
SELECT * FROM products WHERE category = '가구';
```

### 문제 2: 논리 연산자

다음 요구사항에 맞는 SQL을 작성하세요.

1. 전자제품이면서 가격이 200000원 이하인 상품
2. 카테고리가 '가구' 또는 '전자제품'인 상품
3. 재고가 10개 미만이거나 100개 이상인 상품

**예상 답**:
```sql
-- 1
SELECT * FROM products
WHERE category = '전자제품' AND price <= 200000;

-- 2
SELECT * FROM products
WHERE category = '가구' OR category = '전자제품';
-- 또는
SELECT * FROM products
WHERE category IN ('가구', '전자제품');

-- 3
SELECT * FROM products
WHERE stock < 10 OR stock >= 100;
```

### 문제 3: 패턴 매칭

다음 요구사항에 맞는 SQL을 작성하세요.

1. 상품명에 '노'가 포함된 상품 조회
2. 상품명이 '의'로 시작하는 상품 조회
3. 상품명이 정확히 2글자인 상품 조회

**예상 답**:
```sql
-- 1
SELECT * FROM products WHERE product_name LIKE '%노%';

-- 2
SELECT * FROM products WHERE product_name LIKE '의%';

-- 3
SELECT * FROM products WHERE product_name LIKE '__';
```

### 문제 4: 복합 조건

다음 요구사항을 SQL로 작성하세요.

"전자제품 중에서 가격이 50000원 이상 500000원 이하이고, 재고가 20개 이상인 상품"

**예상 답**:
```sql
SELECT product_name, price, stock
FROM products
WHERE category = '전자제품'
  AND price BETWEEN 50000 AND 500000
  AND stock >= 20;
```

---

## 강사 가이드

### 핵심 포인트

1. **WHERE는 필터**: 조건에 맞는 행만 선택
2. **NULL 비교**: `IS NULL` / `IS NOT NULL` 사용
3. **AND vs OR**: AND는 모든 조건 만족, OR는 하나만 만족
4. **괄호 사용**: 복잡한 조건에서 우선순위 명확히
5. **LIKE 성능**: 앞에 `%`가 있으면 인덱스를 사용하지 못함

### 자주 하는 질문

**Q: `=` 대신 `==`를 쓰면 안 되나요?**
A: SQL에서는 `=`만 사용합니다. `==`는 프로그래밍 언어에서 사용하는 표현입니다.

**Q: `AND`와 `OR`를 같이 쓸 때 우선순위는?**
A: `AND`가 `OR`보다 우선순위가 높습니다. 헷갈리면 괄호를 사용하세요.
```sql
-- 이 두 쿼리는 다릅니다
WHERE a = 1 OR b = 2 AND c = 3
WHERE (a = 1 OR b = 2) AND c = 3
```

**Q: LIKE를 여러 번 쓸 수 있나요?**
A: 네. `WHERE name LIKE '%A%' AND name LIKE '%B%'`처럼 사용 가능합니다.

**Q: NULL인 값은 `!=` 비교에 포함되나요?**
A: 아니요. NULL은 모든 비교 연산에서 제외됩니다. `IS NULL`로 따로 확인해야 합니다.

### 실습 진행 팁

1. **단계별 연습**: 비교 → 논리 → 범위 → 패턴 순서
2. **결과 확인**: 각 쿼리 실행 후 결과가 예상과 맞는지 확인
3. **복잡한 조건**: 간단한 조건부터 시작해서 점진적으로 복잡하게
4. **NULL 테스트**: NULL 데이터를 직접 넣어보고 동작 확인

---

## 요약

- **WHERE**: 조건에 맞는 데이터만 필터링
- **비교 연산자**: `=`, `!=`, `>`, `<`, `>=`, `<=`
- **논리 연산자**: `AND`, `OR`, `NOT`
- **범위 연산자**: `BETWEEN`, `IN`
- **패턴 매칭**: `LIKE` (`%`: 여러 문자, `_`: 한 문자)
- **NULL 처리**: `IS NULL`, `IS NOT NULL`
- **괄호**: 복잡한 조건에서 우선순위 명확히
- **쿼리 실행 순서**: `FROM` → `WHERE` → `SELECT`

**다음 단계**: ORDER BY와 LIMIT로 결과를 정렬하고 제한하는 방법을 배웁니다!
