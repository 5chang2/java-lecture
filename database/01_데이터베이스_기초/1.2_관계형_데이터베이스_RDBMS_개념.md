# 1.2. 관계형 데이터베이스 (RDBMS) 개념

> 관계형 데이터베이스의 구조를 이해하고, 테이블 간의 관계를 설정할 수 있다.

---

## 1. 관계형 데이터베이스란?

### RDBMS의 정의
**RDBMS (Relational Database Management System)**는 데이터를 **표(테이블)** 형태로 저장하고, 테이블들 간의 **관계(Relationship)**를 통해 데이터를 관리하는 시스템입니다.

**핵심 개념**
- 데이터는 **테이블(Table)**에 저장됩니다
- 테이블은 **행(Row)**과 **열(Column)**로 구성됩니다
- 테이블끼리 **관계(Relation)**를 맺을 수 있습니다

### 왜 "관계형"인가?
여러 테이블을 **서로 연결(관계)**하여 데이터 중복을 줄이고 효율적으로 관리하기 때문입니다.

**예시**
```
학생 테이블과 수강 테이블을 연결하여
"홍길동 학생이 수강하는 과목"을 쉽게 찾을 수 있음
```

---

## 2. 테이블의 구조

### 테이블 (Table)
데이터를 저장하는 기본 단위입니다. 엑셀의 시트와 비슷합니다.

**예시: students 테이블**
```
+----------+----------+-----+------------+
| 학번     | 이름     | 나이| 전공       |
+----------+----------+-----+------------+
| 2024001  | 홍길동   | 20  | 컴퓨터공학 |
| 2024002  | 김영희   | 21  | 경영학     |
| 2024003  | 이철수   | 22  | 수학       |
+----------+----------+-----+------------+
```

### 행 (Row) = 레코드 (Record) = 튜플 (Tuple)
테이블의 한 줄, **하나의 데이터 항목**을 의미합니다.

```
예: (2024001, 홍길동, 20, 컴퓨터공학)
```
→ 한 명의 학생 정보

### 열 (Column) = 속성 (Attribute) = 필드 (Field)
테이블의 세로 항목, **데이터의 특성**을 의미합니다.

```
예: 학번, 이름, 나이, 전공
```
→ 학생이 가진 속성들

---

## 3. 키 (Key)의 개념

### 기본키 (Primary Key, PK)
테이블에서 **각 행을 고유하게 식별**할 수 있는 열(또는 열의 조합)입니다.

**기본키의 조건**
1. **유일성 (Unique)**: 중복된 값이 없어야 함
2. **최소성 (Minimal)**: 꼭 필요한 최소한의 열만 사용
3. **NOT NULL**: 빈 값(NULL)이 없어야 함

**예시: students 테이블**
```sql
학번: 2024001  ← 기본키 (학번은 절대 중복되지 않음)
이름: 홍길동   ← 기본키 X (동명이인 가능)
```

### 외래키 (Foreign Key, FK)
다른 테이블의 기본키를 참조하는 열입니다.
**테이블 간의 관계를 연결**하는 역할을 합니다.

**예시: courses 테이블**
```
+----------+-----------+---------+
| 수강번호 | 학번(FK)  | 과목명  |
+----------+-----------+---------+
| 1        | 2024001   | 자바    |
| 2        | 2024001   | DB      |
| 3        | 2024002   | 자바    |
+----------+-----------+---------+
```
→ `학번` 열이 students 테이블의 `학번`을 참조 (외래키)

### 후보키 (Candidate Key)
기본키가 될 수 있는 후보입니다.

```
students 테이블:
- 학번 ← 후보키 (유일함)
- 이메일 ← 후보키 (유일함)
- 이름 ← 후보키 X (중복 가능)
```

### 대체키 (Alternate Key)
후보키 중에서 기본키로 선택되지 않은 키입니다.

```
기본키: 학번
대체키: 이메일
```

---

## 4. 테이블 간의 관계

### 1:1 관계 (One-to-One)
한 테이블의 행이 다른 테이블의 **정확히 한 행**과 연결됩니다.

**사용 목적**
- **데이터 분리**: 보안이 필요한 정보를 별도 테이블로 분리
- **성능 최적화**: 자주 사용하지 않는 데이터를 분리하여 조회 속도 향상

**예시: 직원과 주차 공간**
```
employees 테이블
+----------+----------+
| 사원번호 | 이름     |
+----------+----------+
| E001     | 홍길동   |
| E002     | 김영희   |
+----------+----------+

parking_spaces 테이블
+----------+-----------+------------+
| 공간번호 | 사원번호  | 주차위치   |
+----------+-----------+------------+
| P001     | E001      | A-101      |
| P002     | E002      | A-102      |
+----------+-----------+------------+
```
→ 한 직원은 하나의 주차 공간만 가짐

### 1:N 관계 (One-to-Many)
한 테이블의 행이 다른 테이블의 **여러 행**과 연결됩니다.
**가장 흔한 관계**입니다.

**특징**
- '일(One)' 쪽 테이블의 **기본키(PK)**가 '다(Many)' 쪽 테이블의 **외래키(FK)**로 포함됩니다

**예시: 학생과 수강**
```
students 테이블 (1)
+----------+----------+
| 학번     | 이름     |
+----------+----------+
| 2024001  | 홍길동   |
| 2024002  | 김영희   |
+----------+----------+

courses 테이블 (N)
+----------+-----------+---------+
| 수강번호 | 학번(FK)  | 과목명  |
+----------+-----------+---------+
| 1        | 2024001   | 자바    |
| 2        | 2024001   | DB      |  ← 홍길동은 여러 과목 수강
| 3        | 2024002   | 자바    |
+----------+-----------+---------+
```
→ 한 학생은 여러 과목을 수강할 수 있음

### N:M 관계 (Many-to-Many)
양쪽 테이블 모두 **여러 행**과 연결됩니다.

**예시: 학생과 과목**
- 한 학생은 여러 과목을 수강
- 한 과목은 여러 학생이 수강

**문제점**: RDBMS는 N:M 관계를 직접 표현할 수 없음

**해결 방법**: **중간 테이블(연결 테이블, Junction Table)**을 만들어 1:N + N:1로 분해

```
students 테이블
+----------+----------+
| 학번(PK) | 이름     |
+----------+----------+
| 2024001  | 홍길동   |
| 2024002  | 김영희   |
+----------+----------+

subjects 테이블
+----------+----------+
| 과목코드 | 과목명   |
+----------+----------+
| CS101    | 자바     |
| CS102    | DB       |
+----------+----------+

enrollments 테이블 (중간 테이블)
+----------+-----------+----------+
| 수강번호 | 학번(FK)  | 과목코드 |
+----------+-----------+----------+
| 1        | 2024001   | CS101    |
| 2        | 2024001   | CS102    |
| 3        | 2024002   | CS101    |
+----------+-----------+----------+
```
→ students ← (1:N) → enrollments ← (N:1) → subjects

---

## 5. 실습 예시: 도서 대출 시스템

### 시나리오
도서관에서 학생들이 책을 대출합니다.

### 필요한 테이블
1. **학생 (students)**: 학생 정보
2. **도서 (books)**: 책 정보
3. **대출 (rentals)**: 대출 기록

### 테이블 설계

**1. students 테이블**
```
+----------+----------+--------------+
| 학번(PK) | 이름     | 연락처       |
+----------+----------+--------------+
| 2024001  | 홍길동   | 010-1111-1111|
| 2024002  | 김영희   | 010-2222-2222|
+----------+----------+--------------+
```

**2. books 테이블**
```
+------------+--------------+----------+
| ISBN(PK)   | 제목         | 저자     |
+------------+--------------+----------+
| 9781234567 | 자바의 정석  | 남궁성   |
| 9789876543 | 파이썬 기초  | 김파이   |
+------------+--------------+----------+
```

**3. rentals 테이블**
```
+----------+-----------+------------+----------+----------+
| 대출번호 | 학번(FK)  | ISBN(FK)   | 대출일   | 반납일   |
+----------+-----------+------------+----------+----------+
| 1        | 2024001   | 9781234567 | 24-01-15 | 24-01-29 |
| 2        | 2024002   | 9789876543 | 24-01-16 | NULL     |
| 3        | 2024001   | 9789876543 | 24-01-20 | 24-02-03 |
+----------+-----------+------------+----------+----------+
```

### 관계 분석
- **students ↔ rentals**: 1:N (한 학생은 여러 권 대출 가능)
- **books ↔ rentals**: 1:N (한 책은 여러 번 대출 가능)

### 이점
```
Q: 홍길동이 대출한 책 목록은?
A: rentals 테이블에서 학번 2024001인 행을 찾고,
   해당 ISBN으로 books 테이블에서 책 정보 조회

Q: '자바의 정석'을 대출한 학생은?
A: books 테이블에서 ISBN을 찾고,
   rentals 테이블에서 해당 ISBN을 가진 행을 찾고,
   students 테이블에서 학생 정보 조회
```

---

## 6. 데이터 무결성 (Data Integrity)

### 개념
데이터베이스에 저장된 데이터가 **정확하고 일관성 있게** 유지되는 것입니다.

### 무결성 제약 조건

#### 1. 개체 무결성 (Entity Integrity)
- **기본키는 NULL이 될 수 없음**
- 각 행은 고유하게 식별되어야 함

```sql
학번(PK): NULL  ← 불가능!
학번(PK): 2024001  ← 가능
```

#### 2. 참조 무결성 (Referential Integrity)
- **외래키 값은 참조하는 테이블의 기본키 값이어야 함**
- 또는 NULL이어야 함

```sql
rentals 테이블:
학번(FK): 2024099  ← 불가능! (students 테이블에 없는 학번)
학번(FK): 2024001  ← 가능 (students 테이블에 존재)
학번(FK): NULL     ← 가능 (대출자 미정)
```

#### 3. 도메인 무결성 (Domain Integrity)
- **각 열의 값은 정의된 도메인 범위 내에 있어야 함**

```sql
나이: -5     ← 불가능! (음수)
나이: 20     ← 가능
나이: 999    ← 불가능! (범위 초과)
```

#### 4. 사용자 정의 무결성
- **비즈니스 규칙에 따른 제약**

```sql
대출일 < 반납일  (반납일이 대출일보다 빠를 수 없음)
재고수량 >= 0    (재고가 음수일 수 없음)
```

---

## 7. SQL (Structured Query Language)

### SQL이란?
RDBMS에서 데이터를 관리하기 위해 사용하는 **표준 언어**입니다.

### SQL의 주요 카테고리

#### 1. DDL (Data Definition Language) - 데이터 정의어
테이블 구조를 정의하고 관리합니다.

```sql
CREATE TABLE students (  -- 테이블 생성
    학번 INT PRIMARY KEY,
    이름 VARCHAR(50),
    나이 INT
);

ALTER TABLE students ADD 전공 VARCHAR(50);  -- 열 추가

DROP TABLE students;  -- 테이블 삭제
```

#### 2. DML (Data Manipulation Language) - 데이터 조작어
데이터를 추가, 수정, 삭제합니다.

```sql
INSERT INTO students VALUES (2024001, '홍길동', 20);  -- 추가

UPDATE students SET 나이 = 21 WHERE 학번 = 2024001;  -- 수정

DELETE FROM students WHERE 학번 = 2024001;  -- 삭제
```

#### 3. DQL (Data Query Language) - 데이터 질의어
데이터를 조회합니다.

```sql
SELECT * FROM students;  -- 전체 조회

SELECT 이름, 나이 FROM students WHERE 나이 >= 20;  -- 조건 조회
```

#### 4. DCL (Data Control Language) - 데이터 제어어
권한을 관리합니다.

```sql
GRANT SELECT ON students TO user1;  -- 권한 부여

REVOKE SELECT ON students FROM user1;  -- 권한 회수
```

---

## 8. RDBMS의 장단점

### 장점
✅ **데이터 무결성**: 제약 조건으로 정확한 데이터 유지
✅ **데이터 일관성**: 중복 최소화로 일관성 보장
✅ **표준 SQL**: 대부분의 RDBMS에서 SQL 사용 가능
✅ **트랜잭션 지원**: 안전한 데이터 처리
✅ **보안**: 세밀한 권한 관리

### 단점
❌ **성능 저하**: 대용량 데이터 처리 시 느려질 수 있음
❌ **확장성 제한**: 수평 확장(여러 서버에 분산)이 어려움
❌ **스키마 변경 어려움**: 테이블 구조 변경 시 기존 데이터 영향
❌ **복잡한 관계**: 테이블이 많아지면 관계 복잡

---

## 실습 문제

### 문제 1: 관계 파악하기

다음 시나리오에서 적절한 관계를 선택하세요.

1. **강사 ↔ 과목**: 한 강사는 여러 과목을 가르칠 수 있고, 한 과목은 여러 강사가 가르칠 수 있다.
   - **관계**: ?

2. **직원 ↔ 사원증**: 한 직원은 하나의 사원증만 가진다.
   - **관계**: ?

3. **고객 ↔ 주문**: 한 고객은 여러 번 주문할 수 있다.
   - **관계**: ?

**답**:
1. N:M (Many-to-Many)
2. 1:1 (One-to-One)
3. 1:N (One-to-Many)

### 문제 2: 테이블 설계하기

다음 요구사항에 맞는 테이블 구조를 설계하세요.

**시나리오**: 학원 관리 시스템
- 학생은 여러 과목을 수강할 수 있다
- 한 과목은 여러 학생이 수강할 수 있다
- 각 학생의 이름, 연락처를 저장한다
- 각 과목의 과목명, 강의실을 저장한다

**힌트**: 테이블은 최소 3개 필요합니다.

```
students 테이블:
+----------+----------+-------------+
| 학번(PK) | 이름     | 연락처      |
+----------+----------+-------------+

subjects 테이블:
+------------+----------+----------+
| 과목코드(PK)| 과목명   | 강의실   |
+------------+----------+----------+

enrollments 테이블:
+----------+----------+------------+
| 수강번호 | 학번(FK) | 과목코드(FK)|
+----------+----------+------------+
```

---

## 강사 가이드

### 핵심 포인트
1. **시각화 필수**: 화이트보드/PPT로 테이블 구조를 그려가며 설명
2. **관계는 실생활 예시로**: 강사-과목, 직원-사원증 등 친숙한 예시 활용
3. **기본키/외래키 비유**: PK=주민등록번호(고유식별자), FK=화살표(다른 테이블 가리킴)
4. **SQL은 간단히만**: 1장에서는 개념 이해가 목표, SQL 문법은 2장에서

### 자주 하는 질문

**Q: 왜 테이블을 여러 개로 나누나요?**
A: 데이터 중복을 줄이고 일관성 유지. 학생 정보를 한 곳에만 저장하면 수정도 한 번만.

**Q: 외래키는 꼭 설정해야 하나요?**
A: 필수는 아니지만 권장. 외래키가 있으면 잘못된 데이터 입력 방지 (참조 무결성).

**Q: N:M 관계는 왜 직접 만들 수 없나요?**
A: RDBMS 구조상 불가능. 중간 테이블로 1:N + N:1로 분해해야 함.

---

## 요약

- **RDBMS**: 테이블 형태로 데이터를 저장하고 관계를 맺는 시스템
- **테이블 구조**: 행(Row/Record/Tuple), 열(Column/Attribute/Field)
- **기본키(PK)**: 각 행을 고유하게 식별하는 열 (유일성, 최소성, NOT NULL)
- **외래키(FK)**: 다른 테이블의 기본키를 참조하는 열 (테이블 간 관계 연결)
- **관계 유형**:
  - **1:1**: 직원 ↔ 사원증
  - **1:N**: 학생 ↔ 수강 (가장 흔함)
  - **N:M**: 학생 ↔ 과목 (중간 테이블 필요)
- **무결성**: 개체, 참조, 도메인, 사용자 정의
- **SQL**: DDL(정의), DML(조작), DQL(조회), DCL(제어)

**다음 단계**: NoSQL 데이터베이스의 개념과 RDBMS와의 차이점을 배웁니다!
