### ## ğŸŒ world ë°ì´í„°ë² ì´ìŠ¤ JOIN ì—°ìŠµ ë¬¸ì œ

> **ğŸ’¡ ì‹¤ìŠµ ì¤€ë¹„**
>
> ëª¨ë“  ë¬¸ì œë¥¼ ì‹œì‘í•˜ê¸° ì „, `world` ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê² ë‹¤ê³  MySQLì— ì•Œë ¤ì£¼ì„¸ìš”.
>
```sql
USE world;
```

---

### ### **Level 1: ê¸°ë³¸ INNER JOIN**

1.  `city` í…Œì´ë¸”ê³¼ `country` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬, ê° ë„ì‹œê°€ ì–´ëŠ êµ­ê°€ì— ì†í•´ ìˆëŠ”ì§€ êµ­ê°€ëª…ê³¼ í•¨ê»˜ ì¡°íšŒí•˜ì„¸ìš”. (ê²°ê³¼ëŠ” ìƒìœ„ 10ê°œë§Œ ì¶œë ¥)
```sql
SELECT
  ci.Name AS 'ë„ì‹œëª…',
  co.Name AS 'êµ­ê°€ëª…'
FROM
  city ci
INNER JOIN
  country co ON ci.CountryCode = co.Code
LIMIT 10;
```

2.  `country` í…Œì´ë¸”ê³¼ `countrylanguage` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬, 'English'ë¥¼ ì‚¬ìš©í•˜ëŠ” êµ­ê°€ë“¤ì˜ ì´ë¦„(Name)ê³¼ í•´ë‹¹ ì–¸ì–´(Language)ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  co.Name,
  cl.Language
FROM
  country co
INNER JOIN
  countrylanguage cl ON co.Code = cl.CountryCode
WHERE
  cl.Language = 'English';
```

3.  `city` í…Œì´ë¸”ê³¼ `country` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬, 'Europe' ëŒ€ë¥™ì— ì†í•œ ë„ì‹œë“¤ì˜ ì´ë¦„ê³¼ í•´ë‹¹ ë„ì‹œì˜ ì¸êµ¬ìˆ˜ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  ci.Name,
  ci.Population
FROM
  city ci
INNER JOIN
  country co ON ci.CountryCode = co.Code
WHERE
  co.Continent = 'Europe';
```

4.  `country` í…Œì´ë¸”ê³¼ `countrylanguage` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬, ê³µì‹ ì–¸ì–´(IsOfficial = 'T')ê°€ ì•„ë‹Œ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” êµ­ê°€ë“¤ì˜ ì´ë¦„ê³¼ ì–¸ì–´, ê³µì‹ ì—¬ë¶€ë¥¼ ì¡°íšŒí•˜ì„¸ìš”. (ê²°ê³¼ëŠ” ìƒìœ„ 10ê°œë§Œ ì¶œë ¥)
```sql
SELECT
  co.Name,
  cl.Language,
  cl.IsOfficial
FROM
  country co
INNER JOIN
  countrylanguage cl ON co.Code = cl.CountryCode
WHERE
  cl.IsOfficial = 'F'
LIMIT 10;
```

5.  `country` í…Œì´ë¸”ì—ì„œ ìˆ˜ë„(Capital)ê°€ ìˆëŠ” êµ­ê°€ë“¤ì˜ ì´ë¦„ê³¼, `city` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ í•´ë‹¹ ìˆ˜ë„ì˜ ì´ë¦„ì„ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  co.Name AS 'êµ­ê°€ëª…',
  ci.Name AS 'ìˆ˜ë„ëª…'
FROM
  country co
INNER JOIN
  city ci ON co.Capital = ci.ID;
```

---

### ### **Level 2: LEFT JOIN ë° ì—¬ëŸ¬ í…Œì´ë¸” JOIN**

1.  `country` í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ `city` í…Œì´ë¸”ì„ `LEFT JOIN`í•˜ì—¬, ëª¨ë“  êµ­ê°€ì˜ ì´ë¦„ê³¼ í•´ë‹¹ êµ­ê°€ì— ì†í•œ ë„ì‹œì˜ ìˆ˜ë¥¼ ê³„ì‚°í•˜ì—¬ ì¡°íšŒí•˜ì„¸ìš”. ë„ì‹œê°€ ì—†ëŠ” êµ­ê°€ë„ ê²°ê³¼ì— í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
```sql
SELECT
  co.Name,
  COUNT(ci.ID) AS 'ë„ì‹œ_ìˆ˜'
FROM
  country co
LEFT JOIN
  city ci ON co.Code = ci.CountryCode
GROUP BY
  co.Name;
```

2.  `country` í…Œì´ë¸”, `city` í…Œì´ë¸”, `countrylanguage` í…Œì´ë¸”ì„ ëª¨ë‘ ì¡°ì¸í•˜ì—¬, 'South America' ëŒ€ë¥™ì— ì†í•œ êµ­ê°€ë“¤ì˜ ê³µì‹ ì–¸ì–´ì™€ ìˆ˜ë„ì˜ ì¸êµ¬ìˆ˜ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  co.Name AS 'êµ­ê°€ëª…',
  cl.Language AS 'ê³µì‹ì–¸ì–´',
  ci.Population AS 'ìˆ˜ë„_ì¸êµ¬'
FROM
  country co
INNER JOIN
  city ci ON co.Capital = ci.ID
INNER JOIN
  countrylanguage cl ON co.Code = cl.CountryCode
WHERE
  co.Continent = 'South America' AND cl.IsOfficial = 'T';
```

3.  `country` í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ `countrylanguage` í…Œì´ë¸”ì„ `LEFT JOIN`í•˜ì—¬, ê³µì‹ ì–¸ì–´ê°€ ì—†ëŠ”(IsOfficial='F'ë§Œ ìˆê±°ë‚˜ ì•„ì˜ˆ ì–¸ì–´ ì •ë³´ê°€ ì—†ëŠ”) êµ­ê°€ì˜ ì´ë¦„ì„ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  co.Name
FROM
  country co
LEFT JOIN
  countrylanguage cl ON co.Code = cl.CountryCode AND cl.IsOfficial = 'T'
WHERE
  cl.Language IS NULL;
```

4.  'United States'ì˜ ëª¨ë“  ë„ì‹œ ì´ë¦„ê³¼, ê° ë„ì‹œê°€ ì†í•œ ì£¼(District)ì˜ ì´ë¦„ì„ í•¨ê»˜ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  ci.Name AS 'ë„ì‹œëª…',
  ci.District AS 'ì£¼'
FROM
  city ci
INNER JOIN
  country co ON ci.CountryCode = co.Code
WHERE
  co.Name = 'United States';
```

5.  ê° ëŒ€ë¥™(Continent)ë³„ë¡œ ê°€ì¥ ì¸êµ¬ê°€ ë§ì€ ë„ì‹œ(city)ì˜ ì´ë¦„ê³¼ ì¸êµ¬ìˆ˜, ê·¸ë¦¬ê³  í•´ë‹¹ ë„ì‹œê°€ ì†í•œ êµ­ê°€ì˜ ì´ë¦„ì„ ì¡°íšŒí•˜ì„¸ìš”. (ì„œë¸Œì¿¼ë¦¬ ë˜ëŠ” ìœˆë„ìš° í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥, ì—¬ê¸°ì„œëŠ” ì„œë¸Œì¿¼ë¦¬ í™œìš©)
```sql
SELECT
  c.Continent,
  c.Name AS CountryName, -- ì´ ë¶€ë¶„ì„ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤ (co.Name -> c.Name)
  ci.Name AS CityName,
  ci.Population
FROM
  country c
INNER JOIN
  city ci ON c.Code = ci.CountryCode
INNER JOIN
  (SELECT
     co.Continent,
     MAX(ci.Population) AS MaxPop
   FROM
     country co
   INNER JOIN
     city ci ON co.Code = ci.CountryCode
   GROUP BY
     co.Continent) AS max_pop_per_continent ON c.Continent = max_pop_per_continent.Continent AND ci.Population = max_pop_per_continent.MaxPop;
```

---

### ### **Level 3: SELF JOIN ë° ë³µí•© JOIN ì‘ìš©**

1.  `country` í…Œì´ë¸”ì„ `SELF JOIN`í•˜ì—¬, ê°™ì€ ëŒ€ë¥™(Continent)ì— ì†í•˜ë©´ì„œ ì¸êµ¬ëŠ” 5ì²œë§Œëª… ì´ìƒ ì°¨ì´ ë‚˜ëŠ” êµ­ê°€ ìŒì˜ ëª©ë¡ì„ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  c1.Name AS Country1,
  c2.Name AS Country2,
  c1.Continent
FROM
  country c1
INNER JOIN
  country c2 ON c1.Continent = c2.Continent AND c1.Code < c2.Code
WHERE
  ABS(c1.Population - c2.Population) >= 50000000;
```

2.  ì¸êµ¬ê°€ 100ë§Œ ì´ìƒì¸ ë„ì‹œë“¤ ì¤‘ì—ì„œ, ê°™ì€ êµ­ê°€ì— ì†í•˜ë©´ì„œ ì¸êµ¬ê°€ ë¹„ìŠ·í•œ(ì°¨ì´ê°€ 1% ë¯¸ë§Œ) ë„ì‹œ ìŒì„ ì°¾ì•„ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  c1.Name AS City1,
  c1.Population AS Pop1,
  c2.Name AS City2,
  c2.Population AS Pop2,
  c1.CountryCode
FROM
  city c1
INNER JOIN
  city c2 ON c1.CountryCode = c2.CountryCode AND c1.ID < c2.ID
WHERE
  c1.Population >= 1000000
  AND ABS(c1.Population - c2.Population) / c1.Population < 0.01;
```

3.  `countrylanguage` í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬, ë‘ ê°œ ì´ìƒì˜ êµ­ê°€ì—ì„œ ê³µì‹ ì–¸ì–´('T')ë¡œ ì§€ì •ëœ ì–¸ì–´ë“¤ì˜ ëª©ë¡ê³¼, í•´ë‹¹ ì–¸ì–´ë¥¼ ê³µì‹ ì–¸ì–´ë¡œ ì‚¬ìš©í•˜ëŠ” êµ­ê°€ì˜ ìˆ˜ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  Language,
  COUNT(CountryCode) AS NumberOfCountries
FROM
  countrylanguage
WHERE
  IsOfficial = 'T'
GROUP BY
  Language
HAVING
  NumberOfCountries >= 2
ORDER BY
  NumberOfCountries DESC;
```

4.  ëŒ€ë¥™(Continent)ë³„ë¡œ í‰ê·  GNPê°€ ê°€ì¥ ë†’ì€ êµ­ê°€ì™€ ê°€ì¥ ë‚®ì€ êµ­ê°€ì˜ ì´ë¦„, ê·¸ë¦¬ê³  í•´ë‹¹ ëŒ€ë¥™ì˜ í‰ê·  GNPë¥¼ í•¨ê»˜ ì¡°íšŒí•˜ì„¸ìš”. (ë³µì¡í•œ ì¿¼ë¦¬, ìœˆë„ìš° í•¨ìˆ˜ ì‚¬ìš© ì¶”ì²œ)
```sql
WITH RankedCountries AS (
  SELECT
	Name,
	Continent,
	GNP,
	ROW_NUMBER() OVER(PARTITION BY Continent ORDER BY GNP DESC) as rn_desc,
	ROW_NUMBER() OVER(PARTITION BY Continent ORDER BY GNP ASC) as rn_asc,
	AVG(GNP) OVER(PARTITION BY Continent) as avg_gnp
  FROM country
  WHERE GNP > 0
)
SELECT
  Continent,
  MAX(CASE WHEN rn_desc = 1 THEN Name END) AS HighestGNPCountry,
  MAX(CASE WHEN rn_asc = 1 THEN Name END) AS LowestGNPCountry,
  AVG(avg_gnp) AS ContinentAvgGNP
FROM RankedCountries
WHERE rn_desc = 1 OR rn_asc = 1
GROUP BY Continent;
```

5.  `country` í…Œì´ë¸”ê³¼ `city` í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬, êµ­ê°€ì˜ ì¸êµ¬ìˆ˜ ëŒ€ë¹„ ìˆ˜ë„ì˜ ì¸êµ¬ìˆ˜ ë¹„ìœ¨(ìˆ˜ë„ ì§‘ì¤‘ë„)ì„ ê³„ì‚°í•˜ê³ , ì´ ë¹„ìœ¨ì´ ê°€ì¥ ë†’ì€ ìƒìœ„ 5ê°œ êµ­ê°€ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
```sql
SELECT
  co.Name AS CountryName,
  ci.Name AS CapitalName,
  (ci.Population / co.Population) * 100 AS CapitalConcentrationRatio
FROM
  country co
INNER JOIN
  city ci ON co.Capital = ci.ID
WHERE
  co.Population > 0
ORDER BY
  CapitalConcentrationRatio DESC
LIMIT 5;
```
