# 2.1. ERD (Entity-Relationship Diagram) 작성

> ERD의 개념을 이해하고, 간단한 ERD를 직접 작성할 수 있다.

---

## 1. ERD란?

### 정의
**ERD (Entity-Relationship Diagram)**는 데이터베이스를 설계할 때 데이터의 구조를 시각적으로 표현한 설계도입니다.

집을 짓기 전에 설계도를 그리는 것처럼, 데이터베이스를 만들기 전에 ERD를 그려 전체 구조를 명확하게 정의합니다.

**비유로 이해하기**
```
ERD = 집의 설계도
  → 어떤 방(테이블)이 있고
  → 각 방이 어떻게 연결(관계)되어 있는지 보여줌
```

---

## 2. ERD의 3가지 핵심 요소

### 1. 개체 (Entity)

데이터베이스에 저장할 **정보의 단위**입니다. ERD에서는 **사각형**으로 표현합니다.

```
┌──────────┐
│  회원    │  ← 개체 (사각형)
└──────────┘
```

**예시**: 쇼핑몰 시스템
- `회원`, `상품`, `주문`, `카테고리` 등이 개체

**팁**: 개체는 명사형으로 작성합니다.

### 2. 속성 (Attribute)

각 개체가 가지는 **구체적인 정보 항목**입니다. 개체 내부에 목록으로 표시합니다.

```
┌──────────────┐
│    회원      │
├──────────────┤
│ 회원ID (PK)  │  ← 기본키 (Primary Key)
│ 이름         │
│ 이메일       │
│ 가입일       │
└──────────────┘
```

**주요 속성**:
- **기본키 (PK)**: 각 행을 유일하게 식별하는 속성 (예: 회원ID, 주문번호)
- **외래키 (FK)**: 다른 테이블의 기본키를 참조하는 속성

### 3. 관계 (Relationship)

개체 간의 **논리적 연관성**입니다. 선으로 표현합니다.

```
회원 -------< 주문
 1            N

"한 명의 회원은 여러 개의 주문을 할 수 있다"
```

---

## 3. 관계의 종류 (Cardinality)

### 1:1 관계 (One-to-One)

개체 A의 한 개 데이터가 개체 B의 한 개 데이터와만 연결됩니다.

**예시**: 회원 ↔ 회원 프로필
```
회원 |-------| 회원프로필
     1       1

한 명의 회원은 하나의 프로필만 가짐
```

**사용 목적**:
- 보안이 필요한 정보 분리 (예: 비밀번호, 개인정보)
- 자주 사용하지 않는 데이터 분리

### 1:N 관계 (One-to-Many)

개체 A의 한 개 데이터가 개체 B의 여러 개 데이터와 연결됩니다. **가장 흔한 관계**입니다.

**예시**: 회원 ↔ 게시글
```
회원 |-------< 게시글
     1         N

한 명의 회원은 여러 개의 게시글을 작성할 수 있음
```

**실제 구현**: '다(N)' 쪽 테이블에 외래키(FK)를 추가합니다.

```sql
-- 게시글 테이블에 회원ID(FK) 추가
CREATE TABLE posts (
    post_id INT PRIMARY KEY,
    title VARCHAR(255),
    content TEXT,
    user_id INT,  -- 외래키
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);
```

### N:M 관계 (Many-to-Many)

양쪽 개체 모두 여러 개의 데이터와 연결됩니다.

**예시**: 학생 ↔ 과목
```
학생 >-------< 과목

한 학생은 여러 과목을 수강
한 과목에는 여러 학생이 등록
```

**문제점**: RDBMS는 N:M 관계를 직접 구현할 수 없음

**해결 방법**: **중간 테이블(연결 테이블, Junction Table)** 생성

```
학생 |-------< 수강신청 >-------| 과목
     1         N       N         1

N:M을 두 개의 1:N으로 분해
```

**실제 구현**:
```sql
-- 학생 테이블
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    name VARCHAR(50)
);

-- 과목 테이블
CREATE TABLE subjects (
    subject_id INT PRIMARY KEY,
    subject_name VARCHAR(50)
);

-- 수강신청 테이블 (중간 테이블)
CREATE TABLE enrollments (
    enrollment_id INT PRIMARY KEY,
    student_id INT,
    subject_id INT,
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (subject_id) REFERENCES subjects(subject_id)
);
```

---

## 4. 까마귀발 표기법 (Crow's Foot Notation)

가장 널리 사용되는 ERD 표기법입니다. 선의 모양으로 관계를 표현합니다.

### 기본 기호

```
|  : 하나 (One)
<  : 여러 개 (Many) - 까마귀발 모양
O  : 선택 (Optional, NULL 가능)
|  : 필수 (Mandatory, NOT NULL)
```

### 관계 표현

**1:1 관계**
```
회원 |-------| 프로필
```

**1:N 관계**
```
회원 |-------< 게시글
```

**N:M 관계 (중간 테이블 사용)**
```
학생 |-------< 수강신청 >-------| 과목
```

**선택 관계 (NULL 가능)**
```
게시글 |O-------| 첨부파일
         └─ O는 첨부파일이 없을 수도 있음을 의미
```

---

## 5. ERD 작성 도구

### 추천 도구

1. **MySQL Workbench** 
   - MySQL 설치 시 함께 제공
   - ERD 자동 생성 및 DB 연동 가능
   - [공식 가이드](https://dev.mysql.com/doc/workbench/en/)

2. **draw.io (diagrams.net)**
   - 웹 브라우저에서 바로 사용
   - 다양한 도형과 템플릿 제공
   - https://app.diagrams.net/

3. **ERDCloud**
   - 한국어 지원
   - 간단한 인터페이스
   - https://www.erdcloud.com/


### MySQL Workbench에서 ERD 생성하기

```
1. MySQL Workbench 실행
2. Database → Reverse Engineer (기존 DB에서 ERD 생성)
   또는
   File → New Model (새 ERD 작성)
3. Add Diagram 클릭
4. 테이블 추가 및 관계 설정
5. Database → Forward Engineer (ERD에서 SQL 생성)
```

**참고 링크**: [Workbench ERD 생성 방법](https://inpa.tistory.com/entry/MYSQL-%F0%9F%93%9A-%EC%9B%8C%ED%81%AC%EB%B2%A4%EC%B9%98%EC%97%90%EC%84%9C-%ED%85%8C%EC%9D%B4%EB%B8%94-ERD-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0)

---

## 6. ERD 작성 단계

### 1단계: 요구사항 분석

**질문**: 어떤 데이터를 저장해야 하나?

**예시**: 블로그 시스템
```
- 회원이 글을 작성할 수 있어야 함
- 각 글에는 댓글을 달 수 있어야 함
- 글에는 여러 개의 태그를 붙일 수 있어야 함
```

### 2단계: 개체 도출

**명사를 찾아라!**

```
회원, 글, 댓글, 태그
```

### 3단계: 속성 정의

각 개체가 가져야 할 정보를 정의합니다.

```
회원: 회원ID, 이름, 이메일, 비밀번호, 가입일
글: 글ID, 제목, 내용, 작성일, 회원ID
댓글: 댓글ID, 내용, 작성일, 회원ID, 글ID
태그: 태그ID, 태그명
```

### 4단계: 관계 설정

개체 간의 관계를 파악합니다.

```
회원 ↔ 글: 1:N (한 회원은 여러 글 작성)
글 ↔ 댓글: 1:N (한 글에 여러 댓글)
회원 ↔ 댓글: 1:N (한 회원은 여러 댓글 작성)
글 ↔ 태그: N:M (한 글에 여러 태그, 한 태그는 여러 글)
```

### 5단계: ERD 그리기

```
┌──────────┐     ┌──────────┐     ┌──────────┐
│  회원    │     │   글     │     │  댓글    │
├──────────┤     ├──────────┤     ├──────────┤
│회원ID(PK)│<----│글ID(PK)  │<----│댓글ID(PK)│
│이름      │  1:N│제목      │  1:N│내용      │
│이메일    │     │내용      │     │작성일    │
│비밀번호  │     │작성일    │     │회원ID(FK)│
└──────────┘     │회원ID(FK)│     │글ID(FK)  │
                 └──────────┘     └──────────┘
                       N
                       |
                   ┌───┴───┐
                   │글_태그 │ (중간 테이블)
                   ├───────┤
                   │글ID(FK)│
                   │태그ID(FK)
                   └───────┘
                       N
                       |
                 ┌──────────┐
                 │  태그    │
                 ├──────────┤
                 │태그ID(PK)│
                 │태그명    │
                 └──────────┘
```

---

## 실습 문제

### 문제 1: 간단한 ERD 읽기

다음 ERD를 보고 물음에 답하세요.

```
회원 |-------< 주문 >-------| 상품
     1         N   N         1
```

**질문**:
1. 한 회원은 몇 개의 주문을 할 수 있나요?
2. 한 주문에는 몇 개의 상품이 포함될 수 있나요?
3. 중간 테이블의 이름을 무엇으로 하면 좋을까요?

**답**:
1. 여러 개 (1:N 관계)
2. 여러 개 (N:M 관계이므로 중간 테이블 필요)
3. `주문상세` 또는 `Order_Details`

### 문제 2: ERD 작성하기

다음 요구사항에 맞는 ERD를 작성하세요.

**시나리오**: 온라인 강의 플랫폼
- 강사는 여러 강의를 개설할 수 있다
- 학생은 여러 강의를 수강할 수 있다
- 한 강의에는 여러 학생이 등록할 수 있다

**작성해야 할 것**:
1. 개체 목록
2. 각 개체의 속성 (최소 3개 이상)
3. 개체 간 관계
4. ERD 다이어그램 (손으로 그리거나 도구 사용)

**예상 답**:
```
개체: 강사, 강의, 학생, 수강신청

관계:
- 강사 ↔ 강의: 1:N
- 강의 ↔ 수강신청: 1:N
- 학생 ↔ 수강신청: 1:N
```

### 문제 3: 관계 파악하기

다음 상황의 관계 유형을 파악하세요.

1. **사원 ↔ 부서**: 한 사원은 한 부서에 속하고, 한 부서에는 여러 사원이 있다.
   - **관계**: ?

2. **저자 ↔ 책**: 한 저자는 여러 책을 쓸 수 있고, 한 책은 여러 저자가 쓸 수 있다. (공저)
   - **관계**: ?

3. **직원 ↔ 사원증**: 한 직원은 하나의 사원증만 가진다.
   - **관계**: ?

**답**:
1. 1:N (부서가 '일', 사원이 '다')
2. N:M (중간 테이블 필요: `저자_책`)
3. 1:1

---

## 강사 가이드

### 핵심 포인트
1. **시각적 설명**: 화이트보드나 PPT로 ERD를 그려가며 설명
2. **실제 서비스 예시**: 네이버, 유튜브 등의 ERD를 상상해보며 학습
3. **손으로 먼저 그리기**: 도구 사용 전에 종이에 그려보며 개념 이해
4. **관계가 핵심**: 개체와 속성보다 관계 설정이 더 중요함을 강조

### 자주 하는 질문

**Q: ERD는 꼭 그려야 하나요?**
A: 작은 프로젝트는 생략 가능하지만, 협업 프로젝트에서는 필수. 설계도 없이 집을 짓지 않듯이!

**Q: N:M 관계는 왜 직접 만들 수 없나요?**
A: RDBMS의 테이블 구조상 불가능. 중간 테이블로 두 개의 1:N으로 분해해야 함.

**Q: 어떤 도구를 사용하면 좋나요?**
A: 처음에는 MySQL Workbench 추천. 무료이고 SQL 생성도 가능.

**Q: ERD에서 모든 속성을 다 표현해야 하나요?**
A: 초기 설계에서는 핵심 속성만. 상세 속성은 테이블 명세서에 작성.

### 실습 진행 방법
1. 간단한 요구사항 제시 (예: 쇼핑몰, 블로그)
2. 학생들이 개체와 관계를 파악하도록 유도
3. 종이에 ERD 스케치
4. 도구로 옮겨 정리
5. 다른 학생들과 ERD 공유 및 피드백

---

## 요약

- **ERD**: 데이터베이스 설계도, 데이터 구조를 시각화
- **3가지 요소**: 개체(사각형), 속성(목록), 관계(선)
- **관계 유형**:
  - **1:1**: 직원 ↔ 사원증
  - **1:N**: 회원 ↔ 게시글 (가장 흔함)
  - **N:M**: 학생 ↔ 과목 (중간 테이블 필요)
- **까마귀발 표기법**: 선의 모양으로 관계 표현
- **작성 단계**: 요구사항 → 개체 → 속성 → 관계 → ERD
- **도구**: MySQL Workbench, draw.io, ERDCloud

**다음 단계**: 테이블 간의 관계를 더 자세히 배우고, 실제 관계 설정 방법을 학습합니다!
