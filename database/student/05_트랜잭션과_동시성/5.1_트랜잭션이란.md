# 5.1. 트랜잭션(Transaction) 핵심 요약

### 1. 트랜잭션 기본 개념

- **트랜잭션 (Transaction)**
  - 데이터베이스에서 수행되는 **하나의 논리적인 작업 단위**.
  - 여러 개의 SQL 문을 하나의 작업으로 묶어서, **모두 성공(All)하거나 모두 실패(Nothing)**하도록 보장하는 기능.

- **트랜잭션이 필요한 이유**
  - **데이터 일관성 보장**: 여러 단계의 작업이 중간에 실패할 경우, 이전 작업까지 모두 취소(롤백)하여 데이터가 비정상적인 상태로 남는 것을 방지. (예: 계좌 이체)
  - **동시성 제어**: 여러 사용자가 동시에 같은 데이터를 수정하려고 할 때 발생할 수 있는 충돌을 막고 데이터의 무결성을 지킴.
  - **오류 복구**: 시스템 장애가 발생했을 때, 완료되지 않은 트랜잭션은 자동으로 롤백되어 데이터를 일관된 상태로 복구.

---

### 2. 트랜잭션 제어 명령어 (TCL - Transaction Control Language)

- **`START TRANSACTION` 또는 `BEGIN`**
  - 트랜잭션을 시작.
  - 이 명령어 이후에 실행되는 모든 DML(INSERT, UPDATE, DELETE) 문은 임시 상태가 됨.

- **`COMMIT`**
  - 트랜잭션 내의 모든 변경사항을 데이터베이스에 **최종 반영(확정)**.
  - `COMMIT`을 실행하면 변경사항이 영구적으로 저장됨.

- **`ROLLBACK`**
  - 트랜잭션 내의 모든 변경사항을 **취소**하고, 트랜잭션 시작 이전 상태로 되돌림.

- **`SAVEPOINT`**
  - 긴 트랜잭션 내에서 중간 저장 지점을 설정.
  - `ROLLBACK TO SAVEPOINT 이름;` 구문을 통해 전체가 아닌 특정 지점까지만 롤백 가능.

---

### 3. 자동 커밋 (Autocommit)

- **개념**: 각각의 SQL 문이 실행될 때마다 자동으로 `COMMIT`되는 모드. MySQL은 기본적으로 이 모드가 활성화되어 있음.
- **확인**: `SELECT @@autocommit;` (1: 활성화, 0: 비활성화)
- **변경**: `SET autocommit = 0;`으로 비활성화하면, 모든 변경사항은 수동으로 `COMMIT`이나 `ROLLBACK`을 실행해야 함.
