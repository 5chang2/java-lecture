# 5.3. COMMIT, ROLLBACK, SAVEPOINT 핵심 요약

### 1. `COMMIT` (확정)

- **개념**: 트랜잭션 내에서 실행된 모든 변경사항을 데이터베이스에 **영구적으로 확정(저장)**하는 명령어.
- **특징**:
  - `COMMIT`이 실행되면 변경사항은 더 이상 `ROLLBACK`으로 되돌릴 수 없음.
  - `COMMIT`된 데이터는 다른 모든 사용자(세션)에게 보이게 됨.

---

### 2. `ROLLBACK` (취소)

- **개념**: 트랜잭션 내에서 실행된 모든 변경사항을 **취소**하고, 트랜잭션이 시작되기 이전의 상태로 되돌리는 명령어.
- **특징**: 데이터 수정 중 실수가 발생했을 때 원래 상태로 안전하게 복구하기 위해 사용.

---

### 3. `SAVEPOINT` (부분 롤백)

- **개념**: 하나의 긴 트랜잭션 내에서 **중간 저장 지점**을 설정하는 명령어.
- **구문**:
  - **저장점 설정**: `SAVEPOINT 저장점이름;`
  - **부분 롤백**: `ROLLBACK TO SAVEPOINT 저장점이름;`
- **용도**: 전체 트랜잭션을 취소하지 않고, 특정 부분의 작업만 되돌리고 싶을 때 사용.

---

### 4. 트랜잭션 제어 흐름

```sql
-- 트랜잭션 시작
START TRANSACTION;

-- 작업 1
UPDATE ...;

-- 중간 저장 지점 설정
SAVEPOINT sp1;

-- 작업 2
INSERT ...;

-- 만약 작업 2를 취소하고 싶다면
ROLLBACK TO SAVEPOINT sp1;

-- 만약 모든 작업을 확정하고 싶다면
COMMIT;

-- 만약 모든 작업을 취소하고 싶다면
ROLLBACK;
```

---

### 5. 자동 커밋 (Autocommit)

- **개념**: 각각의 SQL 문이 실행될 때마다 자동으로 `COMMIT`되는 모드. MySQL은 기본적으로 이 모드가 활성화(`ON` 또는 `1`)되어 있음.
- **주의**: `autocommit`이 활성화된 상태에서 `DELETE`나 `UPDATE`를 `WHERE` 없이 실행하면 되돌릴 수 없는 큰 실수가 발생할 수 있음.
- **트랜잭션 사용**: `START TRANSACTION;`을 사용하면 `autocommit` 설정과 관계없이 해당 블록은 명시적인 `COMMIT`이나 `ROLLBACK`이 필요하게 됨. **(이 방법을 권장)**
